(()=>{"use strict";var t=function(t,e,n,i){return new(n||(n=Promise))((function(o,l){function c(t){try{a(i.next(t))}catch(t){l(t)}}function r(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((i=i.apply(t,e||[])).next())}))};const e=e=>t(void 0,void 0,void 0,(function*(){return new Promise(((t,n)=>{chrome.storage.local.get([e],(function(i){void 0===i[e]?n():t(i[e])}))}))})),n=e=>t(void 0,void 0,void 0,(function*(){return new Promise(((t,n)=>{chrome.storage.local.set({allTabs:e},(function(){console.log(e)}))}))}));var i=function(t,e,n,i){return new(n||(n=Promise))((function(o,l){function c(t){try{a(i.next(t))}catch(t){l(t)}}function r(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}a((i=i.apply(t,e||[])).next())}))};const o=/(?:[-a-zA-Z0-9@:%_\+~.#=]{2,256}\.)?([-a-zA-Z0-9@:%_\+~#=]*)\.[a-z]{2,6}\b(?:[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/i;chrome.storage.local.set({allTabs:[]});let l,c,r,a,u=0,d={id:0,domain:"",url:"",title:"",sec:0};function s(){return i(this,void 0,void 0,(function*(){let[t]=yield chrome.tabs.query({active:!0,lastFocusedWindow:!0});return t}))}function f(t){return i(this,void 0,void 0,(function*(){if(c!=t.url||r!=t.title)if(yield function(t){return i(this,void 0,void 0,(function*(){let n=yield e("allTabs");if(0!=n.length){for(let e=0;e<n.length;e++)if(n[e].domain===t)return console.log(n[e].domain+" "+t),!0;return!1}return!1}))}(t.domain)){console.log("loop"),c=t.url,r=t.title;let i=yield e("allTabs");for(let e=0;e<i.length;e++)t.domain===i[e].domain&&(i[e].sec+=t.sec,yield n(i))}else{console.log("here"),c=t.url,r=t.title;let i=yield e("allTabs");const o={id:t.id,domain:t.domain,url:t.url,title:t.title,sec:t.sec};i.push(o),yield n(i)}}))}function v(){return i(this,void 0,void 0,(function*(){clearInterval(a),console.log(`The total time was: ${u} seconds`);let t=yield s();!1!==t.url.includes(".")?(l=t.id,d={id:t.id,domain:`${t.url.match(o)[1]}`,url:t.url,sec:0,title:t.title},u=0,a=setInterval((()=>{u++}),1e3)):console.log("invalid tab")}))}chrome.tabs.onActivated.addListener((function(){return i(this,void 0,void 0,(function*(){if(""===d.url)console.log("starting tab"),yield v();else{yield s();let t=d;t.sec=u,yield v(),yield f(t)}}))})),chrome.tabs.onUpdated.addListener((function(t,e,n){return i(this,void 0,void 0,(function*(){if(l===t&&"complete"===n.status){let t=d;t.sec=u,yield v(),yield f(t)}}))}))})();